<!DOCTYPE html>
<html>
	<head>
		
<title>Titanic - Machine Learning from Disaster-blog</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/user.png">

<link rel="stylesheet" href="/css/index.css">


<meta name="keywords" content="hexoä¸»é¢˜,hexoæ‰å¹³åŒ–ä¸»é¢˜,Quietä¸»é¢˜">
<meta name="description" content="æè¿°">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 6.3.0"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/user.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										HOME
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										ARCHIVE
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>å°w</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">HOME</a>
        </li>
        
        <li>
            <a href="/archives">ARCHIVE</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="about">
    <div class="about-header-background">
        <div class="about-header-background-content">
            <img src="image/touxiang.png" alt="Q">
            <h1> 
                <span>Titanic - Machine Learning from Disaster.</span>
            </h1>
        </div>
    </div>
    
    <div class="about-content" id="content" >
        <div id="article" class="about-content-info">
            <h1 id="æ³°å¦å°¼å…‹å·ç¾éš¾é¢„æµ‹"><a href="#æ³°å¦å°¼å…‹å·ç¾éš¾é¢„æµ‹" class="headerlink" title="æ³°å¦å°¼å…‹å·ç¾éš¾é¢„æµ‹"></a>æ³°å¦å°¼å…‹å·ç¾éš¾é¢„æµ‹</h1><ul>
<li>ä½¿ç”¨Deep Learning åˆ›å»ºä¸€ä¸ªæ¨¡å‹ï¼Œæ¥é¢„æµ‹å“ªäº›ä¹˜å®¢åœ¨æ³°å¦å°¼å…‹å·æ²‰èˆ¹ä¸­å¯ä»¥å¹¸å­˜ä¸‹æ¥ã€‚</li>
</ul>
<br>

<p><img src="/image/Titanic/background.jfif" alt="Titanic"></p>
<br>
<br>

<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul>
<li>The sinking of the <strong>Titanic</strong> is one of the most infamous shipwrecks in history.<br>On April 15, 1912, during her maiden voyage, the widely considered â€œunsinkableâ€ RMS Titanic sank after colliding with an iceberg.   Unfortunately, there werenâ€™t enough lifeboats for everyone onboard, resulting in the death of 1502 out of 2224 passengers and crew.While there was some element of luck involved in surviving, it seems some groups of people were more likely to survive than others.</li>
</ul>
<hr>
<h2 id="æŒ‘æˆ˜"><a href="#æŒ‘æˆ˜" class="headerlink" title="æŒ‘æˆ˜"></a>æŒ‘æˆ˜</h2><ul>
<li>äº†è§£äº†ç›¸å…³ä¿¡æ¯åŠèƒŒæ™¯åï¼Œå†³å®šé‡‡ç”¨<em>PyTorch</em>æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œé€šè¿‡ä½¿ç”¨ä¹˜å®¢æ•°æ®ï¼ˆå³å§“åï¼Œå¹´é¾„ï¼Œæ€§åˆ«ï¼Œç¤¾ä¼šç»æµé˜¶å±‚ç­‰ï¼‰æ„å»º<strong>Titanic</strong>çš„äºŒåˆ†ç±»é¢„æµ‹æ¨¡å‹ã€‚</li>
</ul>
<h5 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h5><pre><code class="python">import pandas as pd
import numpy as np

def data_preprocessed():
    datas = pd.read_csv(&#39;data/train.csv&#39;, delimiter=&#39;,&#39;)
    data = pd.get_dummies(datas[[&#39;Pclass&#39;, &#39;Sex&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Survived&#39;]])
    survive = data.pop(data.columns[3])
    data[&#39;Survived&#39;] = survive

    with open(&#39;train.csv&#39;, &#39;w&#39;)as f:
        np.savetxt(f, data, delimiter=&#39;,&#39;)

def testdata_preprocessed():
    datas = pd.read_csv(&#39;data/test.csv&#39;, delimiter=&#39;,&#39;)
    data = pd.get_dummies(datas[[&#39;Pclass&#39;, &#39;Sex&#39;, &#39;SibSp&#39;, &#39;Parch&#39;]])

    with open(&#39;test.csv&#39;, &#39;w&#39;)as f:
        np.savetxt(f, data, delimiter=&#39;,&#39;)


if __name__ == &#39;__main__&#39;:
    testdata_preprocessed()
    data_preprocessed()

&#39;&#39;&#39;
é‡‡ç”¨pandaså’Œnumpyå¯¹æ•°æ®é›†è¿›è¡Œé¢„å¤„ç†ï¼Œå°†å…¶åˆ†åˆ«ä¿å­˜åœ¨å¯¹åº”çš„csvæ–‡ä»¶ä¸­ã€‚
&#39;&#39;&#39;
</code></pre>
<hr>
<ul>
<li>å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†åï¼Œå¼€å§‹ç¼–å†™ä¸»ç¨‹åºæ„å»ºé¢„æµ‹æ¨¡å‹ã€‚</li>
</ul>
<h5 id="å¯¼å…¥ç›¸åº”æ¨¡å—"><a href="#å¯¼å…¥ç›¸åº”æ¨¡å—" class="headerlink" title="å¯¼å…¥ç›¸åº”æ¨¡å—"></a>å¯¼å…¥ç›¸åº”æ¨¡å—</h5><pre><code class="python">import numpy as np
import pandas as pd
import torch
import matplotlib.pyplot as plt
</code></pre>
<h5 id="ç¼–å†™ç¥ç»ç½‘ç»œæ¨¡å‹"><a href="#ç¼–å†™ç¥ç»ç½‘ç»œæ¨¡å‹" class="headerlink" title="ç¼–å†™ç¥ç»ç½‘ç»œæ¨¡å‹"></a>ç¼–å†™ç¥ç»ç½‘ç»œæ¨¡å‹</h5><pre><code class="python">class Net(torch.nn.Module):
    def __init__(self, n_feature, n_hidden, n_hidden2, n_hidden3, n_output):
        super().__init__()
        self.feature = torch.nn.Linear(n_feature, n_hidden)
        self.layer = torch.nn.Linear(n_hidden, n_hidden2)
        self.layer2 = torch.nn.Linear(n_hidden2, n_hidden3)
        self.predict = torch.nn.Linear(n_hidden3, n_output)
    
    def forward(self, x):
        x = torch.sigmoid(self.feature(x))
        x = torch.sigmoid(self.layer(x))
        x = torch.sigmoid(self.layer2(x))
        x = torch.sigmoid(self.predict(x))
        return x
&#39;&#39;&#39;
æ„å»ºä¸€å±‚è¾“å…¥å±‚ï¼Œä¸¤å±‚éšå«å±‚ï¼Œä¸€å±‚è¾“å‡ºå±‚ã€‚å…¨éƒ¨é‡‡ç”¨sigmoidæ¿€æ´»å‡½æ•°è¿æ¥å±‚ã€‚
&#39;&#39;&#39;
</code></pre>
<h5 id="åŠ è½½æ•°æ®é›†"><a href="#åŠ è½½æ•°æ®é›†" class="headerlink" title="åŠ è½½æ•°æ®é›†"></a>åŠ è½½æ•°æ®é›†</h5><pre><code class="python">def data_handling():
    data_preprocessed()
    data = np.loadtxt(&#39;train.csv&#39;, delimiter=&#39;,&#39;, dtype=np.float32)
    x = torch.from_numpy(data[:, :-1])
    y = torch.from_numpy(data[:, [-1]])

    test_x = np.loadtxt(&#39;test.csv&#39;, delimiter=&#39;,&#39;, dtype=np.float32)
    test_x = torch.from_numpy(test_x)

    test_y = pd.read_csv(&#39;data/gender_submission.csv&#39;, delimiter=&#39;,&#39;, index_col=0)
    test_y = test_y.values
    return x, y, test_x, test_y
&#39;&#39;&#39;
åŠ è½½é¢„å¤„ç†çš„æ•°æ®é›†ï¼Œå’ŒéªŒè¯é›†ã€‚
&#39;&#39;&#39;
</code></pre>
<h5 id="è¿­ä»£è®¡ç®—"><a href="#è¿­ä»£è®¡ç®—" class="headerlink" title="è¿­ä»£è®¡ç®—"></a>è¿­ä»£è®¡ç®—</h5><pre><code class="python">def main():
    all_data = data_handling()
    x = all_data[0]
    y = all_data[1]
    test_x = all_data[2]
    test_y = all_data[3]

    net = Net(5, 330, 300, 215, 1)
    optimizer = torch.optim.Adam(net.parameters(), lr=0.00015)
    loss_func = torch.nn.BCELoss()
    plt.ion()
    plt.show()

    epochs = 1000
    for epoch in range(epochs):
        y_train_hat = net(x)
        loss_train = loss_func(y_train_hat, y)

        optimizer.zero_grad()
        loss_train.backward()
        optimizer.step()

        y_test_hat = net(test_x)
        if epoch % 5 == 0:
            plt.cla()
            spot_1, = plt.plot(test_y, &#39;r*&#39;, lw=2)
            spot_2, = plt.plot(y_test_hat.data.numpy(), &#39;bo&#39;, lw=2)
            plt.xlabel(&#39;epoch&#39;)
            plt.ylabel(&#39;result&#39;)
            plt.legend((spot_1, spot_2), [&#39;real&#39;, &#39;test&#39;])
            plt.pause(0.1)
        if epoch == epochs-1:
            threshold = 0.5
            preduction = (y_test_hat &gt;= threshold).int()
            preduction = preduction.data.numpy()
            result = np.equal(test_y, preduction)
            correct_ratio = np.mean(result)
            print(correct_ratio)
            with open(&#39;result.csv&#39;, &#39;w&#39;)as f:
                np.savetxt(f, preduction, delimiter=&#39;,&#39;, fmt=&#39;%d&#39;)
    plt.ioff()
    plt.show()
&#39;&#39;&#39;
å®šä¹‰è¾“å…¥å±‚å•å…ƒæ•°å³ä¸ºå†³ç­–å˜é‡æ•°ï¼Œéšå«å±‚å„å±‚å•å…ƒæ•°ï¼Œè¾“å‡ºå±‚å•å…ƒæ•°ä¸ºä¸€ã€‚é‡‡ç”¨Adamä¼˜åŒ–å™¨ï¼Œè®¾ç½®å­¦ä¹ ç‡ä¸º0.00015ï¼Œé€‰æ‹©BCELossäºŒåˆ†ç±»æŸå¤±å‡½æ•°ã€‚
å¯¹æ•°æ®é›†è¿›è¡Œ1000æ¬¡è¿­ä»£å­¦ä¹ ã€‚
&#39;&#39;&#39;
</code></pre>
<h5 id="è¿è¡Œç¨‹åº"><a href="#è¿è¡Œç¨‹åº" class="headerlink" title="è¿è¡Œç¨‹åº"></a>è¿è¡Œç¨‹åº</h5><pre><code class="python">if __name__ == &#39;__main__&#39;:
    main()
&#39;&#39;&#39;
è¿è¡Œä¸»ç¨‹åº
&#39;&#39;&#39;
</code></pre>
<hr>
<h2 id="é¢„æµ‹æ¨¡å‹å‡†ç¡®ç‡åŠresultæ•°æ®é›†"><a href="#é¢„æµ‹æ¨¡å‹å‡†ç¡®ç‡åŠresultæ•°æ®é›†" class="headerlink" title="é¢„æµ‹æ¨¡å‹å‡†ç¡®ç‡åŠresultæ•°æ®é›†"></a>é¢„æµ‹æ¨¡å‹å‡†ç¡®ç‡åŠresultæ•°æ®é›†</h2><ul>
<li>é€šè¿‡æ·±åº¦å­¦ä¹ é¢„æµ‹æ¨¡å‹å¾—åˆ°<strong>å¹¸å­˜è€…</strong>æ•°æ®é›†result.csvå¹¶ä¸gender_submission.csvæ•°æ®é›†è¿›è¡Œé¢„æµ‹æ¨¡å‹å‡†ç¡®æ€§çš„éªŒè¯ã€‚</li>
</ul>
<p><img src="/image/Titanic/result.png" alt="result"><br><img src="/image/Titanic/correct.png" alt="correct"></p>
<blockquote>
<p>é¢„æµ‹çš„å‡†ç¡®æ€§åˆ°äº† <strong>97.85%</strong> ï¼Œè¡¨æ˜æ¨¡å‹è®­ç»ƒå¾—è¿˜ä¸é”™ã€‚{åæ¥æäº¤åä¹Ÿç»§ç»­è®­ç»ƒè¿‡å¤šæ¬¡ï¼Œæœ€é«˜åˆ°è¾¾è¿‡ <strong>98.80%</strong> çš„å‡†ç¡®ç‡ï¼}</p>
</blockquote>
<hr>
<h2 id="æäº¤æ•°æ®"><a href="#æäº¤æ•°æ®" class="headerlink" title="æäº¤æ•°æ®"></a>æäº¤æ•°æ®</h2><ul>
<li>æäº¤result.csvç»“æœã€‚</li>
</ul>
<br>

<p><img src="/image/Titanic/grade.png" alt="grade"></p>
<blockquote>
<p>å¾—åˆ°äº† <strong>77.751</strong> åˆ†æ•°ï¼Œæ’å <strong>4502</strong> åæ¬¡ã€‚å¾ˆä¸é”™çš„æˆç»©ï¼ğŸ˜</p>
</blockquote>

        </div>
        <div id=""></div>
    </div>
</div>

		
<div class="footer">
	<div class="Copyright">
		Â©2023 By å°w. ä¸»é¢˜ï¼š<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quietä¸»é¢˜">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari å’Œ Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('false')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet ä¸»é¢˜ %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

